(function(e){function t(t){for(var r,i,a=t[0],c=t[1],h=t[2],d=0,p=[];d<a.length;d++)i=a[d],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&p.push(o[i][0]),o[i]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);u&&u(t);while(p.length)p.shift()();return s.push.apply(s,h||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],r=!0,a=1;a<n.length;a++){var c=n[a];0!==o[c]&&(r=!1)}r&&(s.splice(t--,1),e=i(i.s=n[0]))}return e}var r={},o={app:0},s=[];function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/vue-canvas-shapes/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=t,a=a.slice();for(var h=0;h<a.length;h++)t(a[h]);var u=c;s.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("cd49")},"2a6f":function(e,t,n){},"5c0b":function(e,t,n){"use strict";var r=n("9c0c"),o=n.n(r);o.a},"9c0c":function(e,t,n){},bac4:function(e,t,n){"use strict";var r=n("2a6f"),o=n.n(r);o.a},cd49:function(e,t,n){"use strict";n.r(t);var r=n("2b0e"),o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("PlayGround")],1)},s=[],i=n("9ab4"),a=n("60a3"),c=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"play-ground",on:{keydown:[function(t){return!t.type.indexOf("key")&&90!==t.keyCode&&e._k(t.keyCode,"cmd",void 0,t.key,void 0)?null:e.undoHistory(t)},function(t){return(t.type.indexOf("key")||90===t.keyCode)&&t.ctrlKey?e.undoHistory(t):null}]}},[n("canvas",{ref:"playGround",attrs:{id:"play-ground-canvas",tabindex:"0"},on:{keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"left",37,t.key,["Left","ArrowLeft"])?null:"button"in t&&0!==t.button?null:e.onLeftKey(t)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"right",39,t.key,["Right","ArrowRight"])?null:"button"in t&&2!==t.button?null:e.onRightKey(t)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"up",38,t.key,["Up","ArrowUp"])?null:e.onUpKey(t)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"])?null:e.onDownKey(t)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])?null:e.onESC(t)}],mouseup:e.onMouseUp,mousemove:e.onMouseMove,mousedown:e.onMouseDown}}),n("button",{staticClass:"add-rectangle-button",attrs:{"aria-label":"Add Rectangle"},on:{click:e.addRectangle}},[e._v("+")]),-1!==e.selectedShapeId?n("button",{staticClass:"delete-shape-button",attrs:{"aria-label":"Delete Shape"},on:{click:e.deleteShape}},[e._v(" Delete ")]):e._e()])},h=[],u="https://about-you-pangea.s3.eu-central-1.amazonaws.com",d=u+"/shapes.json",p=8,l=0,f=2*Math.PI,y="#222932",g=8,v=-1,x=-1,b=250,C=function(){function e(){}return e.prototype.getShapes=function(){return i["b"](this,void 0,Promise,(function(){var e,t;return i["e"](this,(function(n){switch(n.label){case 0:return[4,fetch(d)];case 1:return e=n.sent(),[4,e.json()];case 2:return t=n.sent(),[2,t]}}))}))},e}(),S=new C,w=function(e,t){if(e){var n=t.coordinates;e.beginPath(),e.moveTo(n[0].x,n[0].y);for(var r=1;r<n.length;r++)e.lineTo(n[r].x,n[r].y);e.fillStyle=t.color,e.fill(),e.closePath()}},I=function(e,t){e&&(e.beginPath(),e.arc(t.x,t.y,p,l,f),e.fillStyle=y,e.strokeStyle=y,e.fill(),e.stroke())},m=function(e,t,n){if(e){var r=n.coordinates;e.beginPath(),e.moveTo(r[0].x,r[0].y);for(var o=1;o<r.length;o++)e.lineTo(r[o].x,r[o].y);return e.closePath(),e.isPointInPath(t.x,t.y)}return!1},k=function(e,t,n){return!!e&&(e.beginPath(),e.arc(t.x,t.y,p,l,f),e.isPointInPath(n.x,n.y))},H=1,M="0123456789abcdef".split(""),O=function(e,t){var n=Math.random()*e,r=Math.random()*t,o=Math.random()*(e/5-e/6)-e/6,s=Math.random()*(t/3-t/5)-t/5,i=1e4*Math.sin(H++),a="#"+Array.from({length:6},(function(){return M[Math.floor(Math.random()*M.length)]})).join("");return{id:i-Math.floor(i),label:"Sample Rectangle",color:a,coordinates:[{x:n,y:r},{x:n+o,y:r},{x:n+o,y:r+s},{x:n,y:r+s}]}},P=n("b047c"),A=n.n(P),_=n("0644"),j=n.n(_),K=function(e){function t(){var t=e.call(this)||this;return t.ctx=t.getContextValue(),t.shapes=[],t.corners={coordinates:[],shapeId:x},t.draggingCornerIndex=v,t.selectedShapeId=x,t.isCtrlPressed=!1,t.debouncedAddHistory=A()(t.storeCurrentHistory,b),t}return i["d"](t,e),t.prototype.getContextValue=function(){var e=this.$refs.playGround;return e&&e.getContext("2d")},t.prototype.mounted=function(){return i["b"](this,void 0,void 0,(function(){var e,t;return i["e"](this,(function(n){switch(n.label){case 0:return e=this.$refs.playGround,e.width=.9*window.innerWidth,e.height=.9*window.innerHeight,this.ctx=this.getContextValue(),t=this,[4,S.getShapes()];case 1:return t.shapes=n.sent(),this.storeCurrentHistory(this.shapes,{coordinates:[],shapeId:x},this.selectedShapeId),[2]}}))}))},t.prototype.onShapesChanged=function(){this.drawShapes()},t.prototype.onCornersChanged=function(){this.drawShapes()},t.prototype.addRectangle=function(){var e=this.$refs.playGround.getBoundingClientRect(),t=e.width,n=e.height;this.shapes.push(O(t,n)),this.selectedShapeId=x,this.storeCurrentHistory()},t.prototype.deleteShape=function(){var e=this,t=this.shapes.findIndex((function(t){return t.id===e.selectedShapeId}));this.shapes.splice(t,1),this.selectedShapeId=x,this.clearCorners(),this.storeCurrentHistory(this.shapes,{coordinates:[],shapeId:x},this.selectedShapeId),this.$refs.playGround.focus()},t.prototype.undoHistory=function(){if(this.$store.state.canvasHistory.length>1){this.$store.commit("undoHistory");var e=this.$store.getters.lastItem,t=e.shapes,n=e.corners,r=e.selectedShapeId;this.shapes=j()(t),this.corners=j()(n),this.selectedShapeId=r}},t.prototype.onESC=function(){this.hasAnySelectedShape()&&(this.selectedShapeId=x,this.clearCorners(),this.storeCurrentHistory(this.shapes,{coordinates:[],shapeId:x},this.selectedShapeId))},t.prototype.onArrowKey=function(e){var t=this;if(this.hasAnySelectedShape()){var n=this.shapes.findIndex((function(e){return e.id===t.selectedShapeId}));this.shapes[n]=i["a"]({},this.shapes[n],{coordinates:this.shapes[n].coordinates.map(e)}),this.corners.coordinates=this.corners.coordinates.map(e),this.drawShapes(),this.storeCurrentHistory()}},t.prototype.onLeftKey=function(){this.onArrowKey((function(e){return{x:e.x-g,y:e.y}}))},t.prototype.onRightKey=function(){this.onArrowKey((function(e){return{x:e.x+g,y:e.y}}))},t.prototype.onUpKey=function(){this.onArrowKey((function(e){return{x:e.x,y:e.y-g}}))},t.prototype.onDownKey=function(){this.onArrowKey((function(e){return{x:e.x,y:e.y+g}}))},t.prototype.onMouseDown=function(e){var t=this,n=this.getMouseCoordinate(e);this.draggingCornerIndex=this.corners.coordinates.findIndex((function(e){return k(t.ctx,e,n)}));var r=this.shapes.find((function(e){return m(t.ctx,n,e)}));this.selectedShapeId=r&&r.id||x,this.hasAnySelectedShape()||this.hasAnyDraggingCorner()||(this.corners.coordinates.length&&this.storeCurrentHistory(this.shapes,{coordinates:[],shapeId:x},this.selectedShapeId),this.clearCorners(),this.drawShapes())},t.prototype.onMouseUp=function(){this.draggingCornerIndex=v},t.prototype.onMouseMove=function(e){var t=this;if(this.ctx){var n=this.getMouseCoordinate(e);if(this.draggingCornerIndex>v){var r=this.shapes.findIndex((function(e){return e.id===t.corners.shapeId}));this.corners.coordinates[this.draggingCornerIndex]=n,this.shapes[r].coordinates=this.corners.coordinates,this.drawShapes(),this.debouncedAddHistory()}else{var o=this.shapes.find((function(e){return m(t.ctx,n,e)||t.selectedShapeId===e.id})),s=this.corners.coordinates.find((function(e){return k(t.ctx,e,n)}));if(o&&!this.corners.coordinates.length){this.corners.shapeId=o.id;for(var i=0,a=o.coordinates;i<a.length;i++){var c=a[i];I(this.ctx,c),this.corners.coordinates.push(c)}}else o||!this.corners.coordinates.length||s||this.clearCorners()}}},t.prototype.getMouseCoordinate=function(e){var t=this.$refs.playGround.getBoundingClientRect(),n=t.left,r=t.top;return{x:e.clientX-n,y:e.clientY-r}},t.prototype.hasAnySelectedShape=function(){return this.selectedShapeId!==x},t.prototype.hasAnyDraggingCorner=function(){return this.draggingCornerIndex!==v},t.prototype.clearCorners=function(){this.corners={coordinates:[],shapeId:x}},t.prototype.drawShapes=function(){var e=this,t=this.$refs.playGround.getBoundingClientRect(),n=t.width,r=t.height;this.ctx&&this.ctx.clearRect(0,0,n,r),this.shapes.forEach((function(t){return w(e.ctx,t)})),this.corners.coordinates.forEach((function(t){return I(e.ctx,t)}))},t.prototype.storeCurrentHistory=function(e,t,n){void 0===e&&(e=this.shapes),void 0===t&&(t=this.corners),void 0===n&&(n=this.selectedShapeId),this.$store.commit("addHistory",{shapes:j()(e),corners:j()(t),selectedShapeId:n})},i["c"]([Object(a["c"])("shapes")],t.prototype,"onShapesChanged",null),i["c"]([Object(a["c"])("corners")],t.prototype,"onCornersChanged",null),t=i["c"]([Object(a["a"])({name:"play-ground"})],t),t}(a["b"]),$=K,R=$,D=(n("bac4"),n("2877")),G=Object(D["a"])(R,c,h,!1,null,null,null),E=G.exports,T=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i["d"](t,e),t=i["c"]([Object(a["a"])({components:{PlayGround:E}})],t),t}(a["b"]),U=T,L=U,B=(n("5c0b"),Object(D["a"])(L,o,s,!1,null,null,null)),V=B.exports,J=n("2f62");r["a"].use(J["a"]);var z=new J["a"].Store({state:{canvasHistory:[]},mutations:{addHistory:function(e,t){e.canvasHistory.push(t)},undoHistory:function(e){1!==e.canvasHistory.length&&e.canvasHistory.pop()}},getters:{lastItem:function(e){return e.canvasHistory[e.canvasHistory.length-1]}},actions:{},modules:{}});r["a"].config.productionTip=!1,new r["a"]({store:z,render:function(e){return e(V)}}).$mount("#app")}});
//# sourceMappingURL=app.89d89288.js.map